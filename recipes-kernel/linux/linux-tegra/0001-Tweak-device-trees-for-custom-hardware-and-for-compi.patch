From fd4f2ffad242283100c73155e26f05f0d7fd80cc Mon Sep 17 00:00:00 2001
From: Thomas Epperson <thomas.epperson@snapon.com>
Date: Wed, 11 Sep 2024 08:32:41 -0500
Subject: [PATCH] Tweak device trees for custom hardware and for compilation.

---
 arch/arm64/boot/dts/nvidia/Makefile      |  1 +
 arch/arm64/boot/dts/nvidia/tegra210.dtsi |  7 +++----
 arch/arm64/boot/dts/nvidia/xjrad.dts     | 13 +++++++++++++
 3 files changed, 17 insertions(+), 4 deletions(-)
 create mode 100644 arch/arm64/boot/dts/nvidia/xjrad.dts

diff --git a/arch/arm64/boot/dts/nvidia/Makefile b/arch/arm64/boot/dts/nvidia/Makefile
index 0f7cdf3e05c1..98441ba15689 100644
--- a/arch/arm64/boot/dts/nvidia/Makefile
+++ b/arch/arm64/boot/dts/nvidia/Makefile
@@ -3,6 +3,7 @@ dtb-$(CONFIG_ARCH_TEGRA_210_SOC) += tegra210-p2371-0000.dtb
 dtb-$(CONFIG_ARCH_TEGRA_210_SOC) += tegra210-p2371-2180.dtb
 dtb-$(CONFIG_ARCH_TEGRA_210_SOC) += tegra210-p2571.dtb
 dtb-$(CONFIG_ARCH_TEGRA_210_SOC) += tegra210-smaug.dtb
+dtb-$(CONFIG_ARCH_TEGRA_210_SOC) += xjrad.dtb
 
 always		:= $(dtb-y)
 clean-files	:= *.dtb
diff --git a/arch/arm64/boot/dts/nvidia/tegra210.dtsi b/arch/arm64/boot/dts/nvidia/tegra210.dtsi
index 7501bfc2b0f1..13b8a9eee39f 100644
--- a/arch/arm64/boot/dts/nvidia/tegra210.dtsi
+++ b/arch/arm64/boot/dts/nvidia/tegra210.dtsi
@@ -81,7 +81,7 @@
 			resets = <&tegra_car 27>;
 			reset-names = "dc";
 
-			iommus = <&mc TEGRA_SWGROUP_DC>;
+			//iommus = <&mc TEGRA_SWGROUP_DC>;
 
 			nvidia,head = <0>;
 		};
@@ -96,7 +96,7 @@
 			resets = <&tegra_car 26>;
 			reset-names = "dc";
 
-			iommus = <&mc TEGRA_SWGROUP_DCB>;
+			//iommus = <&mc TEGRA_SWGROUP_DCB>;
 
 			nvidia,head = <1>;
 		};
@@ -190,8 +190,7 @@
 			compatible = "nvidia,tegra210-sor1";
 			reg = <0x0 0x54580000 0x0 0x00040000>;
 			interrupts = <GIC_SPI 75 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&tegra_car TEGRA210_CLK_SOR1>,
-				 <&tegra_car TEGRA210_CLK_SOR1_SRC>,
+			clocks = <&tegra_car TEGRA210_CLK_SOR1>, <&tegra_car TEGRA210_CLK_SOR1_SRC>,
 				 <&tegra_car TEGRA210_CLK_PLL_D2_OUT0>,
 				 <&tegra_car TEGRA210_CLK_PLL_DP>,
 				 <&tegra_car TEGRA210_CLK_SOR_SAFE>;
diff --git a/arch/arm64/boot/dts/nvidia/xjrad.dts b/arch/arm64/boot/dts/nvidia/xjrad.dts
new file mode 100644
index 000000000000..c7c7604cdd59
--- /dev/null
+++ b/arch/arm64/boot/dts/nvidia/xjrad.dts
@@ -0,0 +1,13 @@
+// SPDX-License-Identifier: GPL-2.0
+/dts-v1/;
+
+#include <dt-bindings/input/linux-event-codes.h>
+#include <dt-bindings/mfd/max77620.h>
+
+#include <tegra210b01-soc/tegra210b01-soc-base.dtsi>
+#include <tegra210b01-soc/tegra210b01-hdmi-prods.dtsi>
+#include <tegra210b01-soc/tegra210b01-soc-prods.dtsi>
+
+/ {
+
+};
-- 
2.34.1

