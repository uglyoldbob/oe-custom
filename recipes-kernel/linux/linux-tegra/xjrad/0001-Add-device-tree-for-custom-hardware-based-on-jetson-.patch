From 17c8e043117946f3c23423da5da71d5b8d5c2fe3 Mon Sep 17 00:00:00 2001
From: Thomas Epperson <thomas.epperson@snapon.com>
Date: Wed, 11 Sep 2024 08:32:41 -0500
Upstream-Status: Pending
Subject: [PATCH] Add device tree for custom hardware based on jetson nano b01
 board.

---
 arch/arm64/boot/dts/nvidia/xjrad.dts | 11 +++++++++++
 nvidia/arch/arm64/Kconfig            |  7 +++++++
 nvidia/drivers/gpu/host1x/Makefile   |  2 +-
 3 files changed, 19 insertions(+), 1 deletion(-)
 create mode 100644 arch/arm64/boot/dts/nvidia/xjrad.dts

diff --git a/arch/arm64/boot/dts/nvidia/xjrad.dts b/arch/arm64/boot/dts/nvidia/xjrad.dts
new file mode 100644
index 000000000000..3e1756a73557
--- /dev/null
+++ b/arch/arm64/boot/dts/nvidia/xjrad.dts
@@ -0,0 +1,11 @@
+// SPDX-License-Identifier: GPL-2.0
+/dts-v1/;
+
+#include <tegra210b01-soc/tegra210b01-soc-base.dtsi>
+#include <tegra210b01-soc/tegra210b01-hdmi-prods.dtsi>
+#include <tegra210b01-soc/tegra210b01-soc-prods.dtsi>
+
+/ {
+	model = "NVIDIA Jetson Nano Developer Kit";
+	
+};
diff --git a/nvidia/arch/arm64/Kconfig b/nvidia/arch/arm64/Kconfig
index 78c3ec369c14..e83d85f871bf 100644
--- a/nvidia/arch/arm64/Kconfig
+++ b/nvidia/arch/arm64/Kconfig
@@ -23,6 +23,13 @@ config ARCH_TEGRA_19x_SOC
 	help
 	  NVIDIA Tegra Downstream options for 19x family of SoCs
 
+config ARCH_TEGRA_21x_SOC
+	bool "Tegra 21x family SOC (Downstream options)"
+	select PINCTRL
+	default n
+	help
+	  NVIDIA Tegra Downstream options for 21x family of SoCs
+
 config ARCH_TEGRA_23x_SOC
 	bool "Tegra 23x family SOC (Downstream options)"
 	select PINCTRL
diff --git a/nvidia/drivers/gpu/host1x/Makefile b/nvidia/drivers/gpu/host1x/Makefile
index 87be3871cc59..00f93bff0a83 100644
--- a/nvidia/drivers/gpu/host1x/Makefile
+++ b/nvidia/drivers/gpu/host1x/Makefile
@@ -1,7 +1,7 @@
 ccflags-y += -Idrivers/gpu/host1x
 ccflags-y += -I$(srctree.nvidia)/drivers/gpu/host1x
 
-host1x-t186-y = \
+host1x-t186-$(CONFIG_ARCH_TEGRA_18x_SOC) = \
 	dev_t186.o \
 	hw/host1x05.o
 
-- 
2.34.1

