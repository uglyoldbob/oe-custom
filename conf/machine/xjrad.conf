#@TYPE: Machine
#@NAME: xjrad

#@DESCRIPTION: Machine configuration for custom xj radio

require conf/machine/include/orin-nano.inc
require conf/machine/include/devkit-wifi.inc

TNSPEC_BOOTDEV_DEFAULT ?= "mmcblk1p1"
TEGRAFLASH_SDCARD_SIZE ?= "32G"
PARTITION_LAYOUT_TEMPLATE_DEFAULT ?= "flash_t234_qspi_sd.xml"

PREFERRED_PROVIDER_virtual/kernel = "linux-xjrad"
INITRAMFS_IMAGE = ""
INITRAMFS_IMAGE_BUNDLE = ""

KERNEL_DEVICETREE = "uglyoldbob/xjrad.dtb"

unset PREFERRED_PROVIDER_virtual/dtb
PREFERRED_PROVIDER_virtual/bootloader = "u-boot"
UBOOT_CONFIG ??= "sd"
UBOOT_CONFIG[sd] = "xjrad_config,sdcard"
UBOOT_CONFIG[mmc] = "xjrad_config,mmc"
UBOOT_EXTLINUX_ROOT = "root=/dev/mmcblkp2"

DTB_EXTRA_DEPS = ""
EXTERNAL_KERNEL_DEVICETREE = ""

MACHINE_ESSENTIAL_EXTRA_RDEPENDS = "u-boot u-boot-script kernel-devicetree kernel-modules linux-firmware-nvidia-gpu linux-firmware-nvidia-tegra"
MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS = ""
MACHINE_EXTRA_RDEPENDS = ""
MACHINE_EXTRA_RRECOMMENDS = ""

SERIAL_CONSOLES = "115200;ttyS0"

INIT_MANAGER = "systemd"
VIRTUAL-RUNTIME_base-utils = "packagegroup-core-base-utils"
PREFERRED_PROVIDER_virtual/egl = "mesa"
PREFERRED_PROVIDER_virtual/libgles1 = "mesa"
PREFERRED_PROVIDER_virtual/libgles2 = "mesa"
PREFERRED_PROVIDER_virtual/libgles3 = "mesa"
PREFERRED_PROVIDER_virtual/libgl = "mesa"
PREFERRED_PROVIDER_virtual/libgbm = "mesa"
